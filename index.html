<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reprodutor de Vídeos Automático</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        /* Custom CSS for fullscreen video */
        #videoContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 0;
        }
        
        #videoPlayer {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        #controlsOverlay {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            padding: 20px;
            color: white;
            display: none;
            z-index: 10;
        }
        
        #statusBar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            font-size: 14px;
            display: none;
            z-index: 10;
        }
        
        .progress-container {
            width: 100%;
            height: 5px;
            background: rgba(255,255,255,0.2);
            margin-top: 10px;
        }
        
        .progress-bar {
            height: 100%;
            background: #3b82f6;
            width: 0%;
        }
        
        /* Animation for brief messages */
        @keyframes fadeInOut {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 15px 25px;
            border-radius: 5px;
            font-size: 18px;
            z-index: 20;
            display: none;
            animation: fadeInOut 3s ease-in-out;
        }

        /* Light theme styles */
        .light-theme {
            background-color: #f3f4f6;
            color: #111827;
        }

        .light-theme #settingsPanel {
            background-color: #f9fafb;
            color: #111827;
            border-left: 1px solid #e5e7eb;
        }

        .light-theme #controlsOverlay {
            background: linear-gradient(transparent, rgba(243, 244, 246, 0.7));
            color: #111827;
        }

        .light-theme #statusBar {
            background: rgba(243, 244, 246, 0.7);
            color: #111827;
        }

        .light-theme .progress-container {
            background: rgba(17, 24, 39, 0.2);
        }

        .light-theme .message {
            background: rgba(243, 244, 246, 0.9);
            color: #111827;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .light-theme #videoList {
            background-color: #e5e7eb;
        }

        .light-theme #videoList div:hover {
            background-color: #d1d5db !important;
        }

        .light-theme #videoList .bg-blue-900 {
            background-color: #93c5fd !important;
        }
        
        /* Loading spinner */
        .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        .light-theme .spinner {
            border: 3px solid rgba(0,0,0,0.3);
            border-top-color: #000;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-black text-white">
    <!-- Video Container -->
    <div id="videoContainer">
        <video id="videoPlayer" autoplay></video>
    </div>
    
    <!-- Status Bar (hidden by default) -->
    <div id="statusBar">
        <div class="flex justify-between items-center">
            <span id="currentVideoTitle">Nenhum vídeo carregado</span>
            <span id="scanStatus">Próxima verificação: <span id="nextScanTime">1 minuto</span></span>
        </div>
        <div class="progress-container">
            <div id="scanProgress" class="progress-bar"></div>
        </div>
    </div>
    
    <!-- Controls Overlay (hidden by default) -->
    <div id="controlsOverlay">
        <div class="flex justify-between items-center mb-2">
            <span id="videoTime">00:00 / 00:00</span>
            <span id="videoCount">0/0 vídeos</span>
        </div>
        <div class="flex items-center space-x-4">
            <button id="prevBtn" class="p-2 rounded-full hover:bg-gray-700">
                <i class="fas fa-step-backward"></i>
            </button>
            <button id="playPauseBtn" class="p-3 rounded-full bg-blue-600 hover:bg-blue-700">
                <i class="fas fa-pause"></i>
            </button>
            <button id="nextBtn" class="p-2 rounded-full hover:bg-gray-700">
                <i class="fas fa-step-forward"></i>
            </button>
            <div class="flex-1 mx-4">
                <input type="range" id="progressBar" min="0" max="100" value="0" class="w-full h-2 rounded-lg appearance-none cursor-pointer">
            </div>
            <button id="volumeBtn" class="p-2 rounded-full hover:bg-gray-700">
                <i class="fas fa-volume-up"></i>
            </button>
            <input type="range" id="volumeControl" min="0" max="100" value="100" class="w-24 h-2 rounded-lg appearance-none cursor-pointer">
            <button id="fullscreenBtn" class="p-2 rounded-full hover:bg-gray-700">
                <i class="fas fa-expand"></i>
            </button>
        </div>
    </div>
    
    <!-- Settings Panel (hidden by default) -->
    <div id="settingsPanel" class="fixed top-0 right-0 bg-gray-900 text-white p-6 w-80 h-full transform translate-x-full transition-transform duration-300 z-20 overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-bold">Configurações</h2>
            <button id="closeSettings" class="p-2 rounded-full hover:bg-gray-700">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="mb-6">
            <h3 class="text-lg font-semibold mb-3">Pasta de Vídeos</h3>
            <div class="flex items-center space-x-2">
                <input type="text" id="folderPath" placeholder="Caminho da pasta" class="flex-1 bg-gray-800 border border-gray-700 rounded px-3 py-2">
                <button id="browseBtn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">
                    <i class="fas fa-folder-open mr-2"></i>Procurar
                </button>
            </div>
            <p class="text-sm text-gray-400 mt-2">Exemplo: C:\Videos ou \\SERVER\Videos</p>
            <div id="pathError" class="text-red-400 text-sm mt-2 hidden"></div>
        </div>
        
        <div class="mb-6">
            <h3 class="text-lg font-semibold mb-3">Verificação Automática</h3>
            <div class="flex items-center space-x-2">
                <input type="number" id="scanInterval" min="1" max="240" value="60" class="w-20 bg-gray-800 border border-gray-700 rounded px-3 py-2">
                <span>minutos</span>
            </div>
            <button id="manualRefresh" class="mt-3 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded flex items-center justify-center">
                <i class="fas fa-sync-alt mr-2"></i>Verificar Agora
                <span id="refreshSpinner" class="spinner ml-2 hidden"></span>
            </button>
        </div>
        
        <div class="mb-6">
            <h3 class="text-lg font-semibold mb-3">Tema</h3>
            <div class="flex items-center space-x-4">
                <button id="lightModeBtn" class="px-4 py-2 rounded border border-gray-600 hover:bg-gray-700">
                    <i class="fas fa-sun mr-2"></i>Claro
                </button>
                <button id="darkModeBtn" class="px-4 py-2 rounded bg-blue-600 hover:bg-blue-700">
                    <i class="fas fa-moon mr-2"></i>Escuro
                </button>
            </div>
        </div>
        
        <div class="mb-6">
            <h3 class="text-lg font-semibold mb-3">Reprodução</h3>
            <div class="flex items-center justify-between mb-2">
                <span>Repetir playlist</span>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="loopPlaylist" class="sr-only peer" checked>
                    <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
            </div>
            <div class="flex items-center justify-between">
                <span>Reproduzir automaticamente</span>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="autoplay" class="sr-only peer" checked>
                    <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                </label>
            </div>
        </div>
        
        <div class="mb-6">
            <h3 class="text-lg font-semibold mb-3">Lista de Vídeos</h3>
            <div id="videoList" class="max-h-60 overflow-y-auto bg-gray-800 rounded p-2">
                <p class="text-gray-400 text-center py-4">Nenhum vídeo encontrado</p>
            </div>
            <div id="scanStatusText" class="text-sm text-gray-400 mt-2 hidden">
                <span id="scanCount">0</span> vídeos encontrados
            </div>
        </div>
        
        <button id="saveSettings" class="w-full bg-green-600 hover:bg-green-700 px-4 py-3 rounded font-semibold">
            <i class="fas fa-save mr-2"></i>Salvar Configurações
        </button>
    </div>
    
    <!-- Brief Message Display -->
    <div id="message" class="message"></div>
    
    <!-- Settings Button (always visible) -->
    <button id="settingsBtn" class="fixed bottom-4 right-4 bg-gray-800 hover:bg-gray-700 p-3 rounded-full z-10">
        <i class="fas fa-cog"></i>
    </button>
    
    <script>
        // App configuration
        const config = {
            videoFormats: ['.mp4', '.avi', '.mkv', '.mov', '.webm', '.flv', '.wmv'],
            defaultFolder: '', // Will be set from localStorage
            scanInterval: 60, // minutes
            currentVideoIndex: 0,
            videoList: [],
            isPlaying: false,
            isFullscreen: false,
            isDarkMode: true,
            loopPlaylist: true,
            autoplay: true,
            showControls: false,
            controlsTimeout: null,
            lastScanTime: null
        };
        
        // DOM Elements
        const videoPlayer = document.getElementById('videoPlayer');
        const videoContainer = document.getElementById('videoContainer');
        const controlsOverlay = document.getElementById('controlsOverlay');
        const statusBar = document.getElementById('statusBar');
        const settingsPanel = document.getElementById('settingsPanel');
        const messageElement = document.getElementById('message');
        const progressBar = document.getElementById('progressBar');
        const volumeControl = document.getElementById('volumeControl');
        const currentVideoTitle = document.getElementById('currentVideoTitle');
        const videoTime = document.getElementById('videoTime');
        const videoCount = document.getElementById('videoCount');
        const scanStatus = document.getElementById('scanStatus');
        const nextScanTime = document.getElementById('nextScanTime');
        const scanProgress = document.getElementById('scanProgress');
        const videoList = document.getElementById('videoList');
        const folderPath = document.getElementById('folderPath');
        const scanInterval = document.getElementById('scanInterval');
        const loopPlaylist = document.getElementById('loopPlaylist');
        const autoplayCheckbox = document.getElementById('autoplay');
        const pathError = document.getElementById('pathError');
        const refreshSpinner = document.getElementById('refreshSpinner');
        const scanStatusText = document.getElementById('scanStatusText');
        const scanCount = document.getElementById('scanCount');
        
        // Buttons
        const playPauseBtn = document.getElementById('playPauseBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const volumeBtn = document.getElementById('volumeBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const settingsBtn = document.getElementById('settingsBtn');
        const closeSettings = document.getElementById('closeSettings');
        const browseBtn = document.getElementById('browseBtn');
        const manualRefresh = document.getElementById('manualRefresh');
        const lightModeBtn = document.getElementById('lightModeBtn');
        const darkModeBtn = document.getElementById('darkModeBtn');
        const saveSettings = document.getElementById('saveSettings');
        
        // Initialize the app
        function initApp() {
            loadSettings();
            setupEventListeners();
            checkFolderAndScan();
            startScanTimer();
            updateUI();
        }
        
        // Load settings from localStorage
        function loadSettings() {
            const savedConfig = localStorage.getItem('videoPlayerConfig');
            if (savedConfig) {
                const parsedConfig = JSON.parse(savedConfig);
                Object.assign(config, parsedConfig);
            }
            
            // Update UI elements with loaded settings
            folderPath.value = config.defaultFolder;
            scanInterval.value = config.scanInterval;
            loopPlaylist.checked = config.loopPlaylist;
            autoplayCheckbox.checked = config.autoplay;
            
            // Set theme
            setTheme(config.isDarkMode);
        }
        
        // Save settings to localStorage
        function saveSettingsToStorage() {
            config.defaultFolder = folderPath.value;
            config.scanInterval = parseInt(scanInterval.value);
            config.loopPlaylist = loopPlaylist.checked;
            config.autoplay = autoplayCheckbox.checked;
            
            localStorage.setItem('videoPlayerConfig', JSON.stringify(config));
            showMessage('Configurações salvas com sucesso!');
        }
        
        // Set theme (true for dark, false for light)
        function setTheme(isDarkMode) {
            config.isDarkMode = isDarkMode;
            
            if (isDarkMode) {
                document.body.classList.remove('light-theme');
                document.body.classList.add('bg-black', 'text-white');
                darkModeBtn.classList.add('bg-blue-600');
                lightModeBtn.classList.remove('bg-blue-600');
            } else {
                document.body.classList.add('light-theme');
                document.body.classList.remove('bg-black', 'text-white');
                lightModeBtn.classList.add('bg-blue-600');
                darkModeBtn.classList.remove('bg-blue-600');
            }
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Video player events
            videoPlayer.addEventListener('play', () => {
                config.isPlaying = true;
                updatePlayPauseButton();
            });
            
            videoPlayer.addEventListener('pause', () => {
                config.isPlaying = false;
                updatePlayPauseButton();
            });
            
            videoPlayer.addEventListener('ended', () => {
                playNextVideo();
            });
            
            videoPlayer.addEventListener('timeupdate', updateProgressBar);
            videoPlayer.addEventListener('volumechange', updateVolumeButton);
            
            // Mouse events for showing/hiding controls
            videoContainer.addEventListener('mousemove', showControls);
            videoContainer.addEventListener('mouseleave', () => {
                if (!config.showControls) hideControls();
            });
            
            // Control buttons
            playPauseBtn.addEventListener('click', togglePlayPause);
            prevBtn.addEventListener('click', playPreviousVideo);
            nextBtn.addEventListener('click', playNextVideo);
            progressBar.addEventListener('input', seekVideo);
            volumeControl.addEventListener('input', changeVolume);
            volumeBtn.addEventListener('click', toggleMute);
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            
            // Settings panel
            settingsBtn.addEventListener('click', toggleSettingsPanel);
            closeSettings.addEventListener('click', toggleSettingsPanel);
            browseBtn.addEventListener('click', browseFolder);
            manualRefresh.addEventListener('click', () => {
                checkFolderAndScan();
            });
            lightModeBtn.addEventListener('click', () => setTheme(false));
            darkModeBtn.addEventListener('click', () => setTheme(true));
            saveSettings.addEventListener('click', () => {
                saveSettingsToStorage();
                startScanTimer(); // Restart timer with new interval
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.code === 'Space') {
                    e.preventDefault();
                    togglePlayPause();
                } else if (e.code === 'ArrowLeft') {
                    seekRelative(-5);
                } else if (e.code === 'ArrowRight') {
                    seekRelative(5);
                } else if (e.code === 'ArrowUp') {
                    changeVolume(5);
                } else if (e.code === 'ArrowDown') {
                    changeVolume(-5);
                } else if (e.code === 'KeyF') {
                    toggleFullscreen();
                } else if (e.code === 'KeyM') {
                    toggleMute();
                } else if (e.code === 'KeyN') {
                    playNextVideo();
                } else if (e.code === 'KeyP') {
                    playPreviousVideo();
                } else if (e.code === 'Escape' && config.isFullscreen) {
                    toggleFullscreen();
                }
            });
        }
        
        // Show controls with timeout
        function showControls() {
            if (config.isFullscreen || config.showControls) {
                controlsOverlay.style.display = 'block';
                statusBar.style.display = 'block';
                config.showControls = true;
                
                clearTimeout(config.controlsTimeout);
                config.controlsTimeout = setTimeout(() => {
                    if (!videoPlayer.paused) {
                        controlsOverlay.style.display = 'none';
                        statusBar.style.display = 'none';
                        config.showControls = false;
                    }
                }, 3000);
            }
        }
        
        // Hide controls immediately
        function hideControls() {
            controlsOverlay.style.display = 'none';
            statusBar.style.display = 'none';
            config.showControls = false;
        }
        
        // Toggle play/pause
        function togglePlayPause() {
            if (videoPlayer.paused) {
                videoPlayer.play();
            } else {
                videoPlayer.pause();
            }
        }
        
        // Update play/pause button
        function updatePlayPauseButton() {
            if (videoPlayer.paused) {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                playPauseBtn.classList.remove('bg-blue-600');
                playPauseBtn.classList.add('bg-green-600');
            } else {
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                playPauseBtn.classList.remove('bg-green-600');
                playPauseBtn.classList.add('bg-blue-600');
            }
        }
        
        // Update progress bar
        function updateProgressBar() {
            const currentTime = videoPlayer.currentTime;
            const duration = videoPlayer.duration || 1;
            const progressPercent = (currentTime / duration) * 100;
            progressBar.value = progressPercent;
            
            // Update time display
            videoTime.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
        }
        
        // Format time (seconds to MM:SS)
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        // Seek video
        function seekVideo() {
            const seekTime = (progressBar.value / 100) * videoPlayer.duration;
            videoPlayer.currentTime = seekTime;
        }
        
        // Seek relative to current position
        function seekRelative(seconds) {
            videoPlayer.currentTime += seconds;
        }
        
        // Update volume button
        function updateVolumeButton() {
            if (videoPlayer.muted || videoPlayer.volume === 0) {
                volumeBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
            } else if (videoPlayer.volume < 0.5) {
                volumeBtn.innerHTML = '<i class="fas fa-volume-down"></i>';
            } else {
                volumeBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
            }
            volumeControl.value = videoPlayer.muted ? 0 : videoPlayer.volume * 100;
        }
        
        // Change volume
        function changeVolume(change) {
            if (typeof change === 'number') {
                // Change by delta (keyboard)
                let newVolume = videoPlayer.volume + (change / 100);
                newVolume = Math.max(0, Math.min(1, newVolume));
                videoPlayer.volume = newVolume;
                videoPlayer.muted = false;
            } else {
                // Change by slider
                videoPlayer.volume = volumeControl.value / 100;
                videoPlayer.muted = false;
            }
            updateVolumeButton();
        }
        
        // Toggle mute
        function toggleMute() {
            videoPlayer.muted = !videoPlayer.muted;
            updateVolumeButton();
        }
        
        // Toggle fullscreen
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                videoContainer.requestFullscreen().catch(err => {
                    console.error(`Error attempting to enable fullscreen: ${err.message}`);
                });
                config.isFullscreen = true;
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
            } else {
                document.exitFullscreen();
                config.isFullscreen = false;
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
            }
        }
        
        // Toggle settings panel
        function toggleSettingsPanel() {
            settingsPanel.classList.toggle('translate-x-full');
            settingsPanel.classList.toggle('translate-x-0');
        }
        
        // Browse folder (simulated in browser environment)
        function browseFolder() {
            // In a real Electron app, this would open a folder dialog
            // For web demo, we'll just simulate it with a prompt
            const path = prompt('Digite o caminho da pasta de vídeos:', folderPath.value);
            if (path !== null) {
                folderPath.value = path;
                checkFolderAndScan();
            }
        }
        
        // Check folder and scan for videos
        function checkFolderAndScan() {
            const folder = folderPath.value.trim();
            
            if (!folder) {
                showMessage('Por favor, selecione uma pasta primeiro');
                return;
            }
            
            // Validate path format
            if (!isValidPath(folder)) {
                pathError.textContent = 'Formato de caminho inválido. Use caminho local (C:\\Videos) ou rede (\\\\SERVER\\Videos)';
                pathError.classList.remove('hidden');
                return;
            }
            
            pathError.classList.add('hidden');
            refreshSpinner.classList.remove('hidden');
            manualRefresh.disabled = true;
            
            // Simulate scanning a folder (in a real app, this would be an API call)
            simulateScanFolder(folder);
        }
        
        // Validate path format
        function isValidPath(path) {
            // Windows local path: C:\, C:\Users\, C:\Users\yasmi\Videos\
            const windowsLocalPath = /^[a-zA-Z]:\\(?:[^\\/:?"<>|\r\n]+\\?)*$/;
            // Windows network path: \\server\share, \\server\share\folder
            const windowsNetworkPath = /^\\\\[^\\/:?"<>|\r\n]+(\\[^\\/:?"<>|\r\n]+)+\\?$/;
            // Unix-like path: /home/user/videos/
            const unixPath = /^\/(?:[^\/:?"<>|\r\n]+\/)*$/;
            return windowsLocalPath.test(path) || 
                   windowsNetworkPath.test(path) || 
                   unixPath.test(path);
        }
        
        // Simulate scanning a folder (replace with actual API call in real app)
        function simulateScanFolder(folder) {
            showMessage('Verificando pasta...');
            scanProgress.style.width = '0%';
            videoList.innerHTML = '<p class="text-gray-400 text-center py-4">Verificando pasta...</p>';
            
            // Simulate progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += 5;
                scanProgress.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    onFolderScanComplete(folder);
                }
            }, 100);
        }
        
        // Called when folder scan is complete
        function onFolderScanComplete(folder) {
            refreshSpinner.classList.add('hidden');
            manualRefresh.disabled = false;
            
            // In a real app, this would be replaced with actual file system scanning
            // For demo purposes, we'll simulate finding files based on the folder path
            
            // First check if we can access the folder
            if (!simulateCheckFolderAccess(folder)) {
                pathError.textContent = 'Não foi possível acessar a pasta. Verifique o caminho e as permissões.';
                pathError.classList.remove('hidden');
                videoList.innerHTML = '<p class="text-gray-400 text-center py-4">Erro ao acessar pasta</p>';
                scanStatusText.classList.add('hidden');
                return;
            }
            
            // Now find videos in the folder
            const foundVideos = simulateFindVideos(folder);
            
            if (foundVideos.length === 0) {
                showMessage('Nenhum vídeo encontrado na pasta');
                videoList.innerHTML = '<p class="text-gray-400 text-center py-4">Nenhum vídeo encontrado</p>';
                scanStatusText.classList.add('hidden');
                return;
            }
            
            // Update video list
            config.videoList = foundVideos;
            updateVideoListUI();
            
            // Play first video if not already playing
            if (config.videoList.length > 0 && (config.currentVideoIndex === 0 || !videoPlayer.src)) {
                playVideoByIndex(0);
            }
            
            // Update status
            config.lastScanTime = new Date();
            updateScanStatus();
            showMessage(`Encontrados ${foundVideos.length} vídeos`);
            
            // Update scan count
            scanCount.textContent = foundVideos.length;
            scanStatusText.classList.remove('hidden');
        }
        
        // Simulate checking folder access
        function simulateCheckFolderAccess(folder) {
            // In a real app, this would check actual folder access
            // For demo, we'll simulate some common errors
            
            // Check if path looks like a network path
            const isNetworkPath = folder.startsWith('\\\\');
            
            // Simulate network path access issues
            if (isNetworkPath) {
                // 20% chance to simulate network error
                if (Math.random() < 0.2) {
                    return false;
                }
            }
            
            // 10% chance to simulate any other access error
            if (Math.random() < 0.1) {
                return false;
            }
            
            return true;
        }
        
        // Simulate finding video files based on folder path
        function simulateFindVideos(folder) {
            // This is a simulation - in a real app, you would scan the actual file system
            
            // Generate some realistic file names based on the folder type
            const isNetworkPath = folder.startsWith('\\\\');
            const isLocalPath = folder.includes(':\\') || folder.startsWith('/');
            
            let videoFiles = [];
            
            if (isNetworkPath) {
                // Network share - simulate corporate videos
                videoFiles = [
                    'Apresentação Corporativa.mp4',
                    'Treinamento de Segurança.mkv',
                    'Reunião Mensal.avi',
                    'Demonstração de Produto.mp4',
                    'Instruções de Uso.webm',
                    'Vídeo Institucional.mov'
                ];
            } else if (isLocalPath) {
                // Local path - simulate personal videos
                videoFiles = [
                    'Férias 2023.mp4',
                    'Aniversário.mov',
                    'Filme Favorito.mkv',
                    'Documentário.mp4',
                    'Gravação de Tela.webm',
                    'Vídeo do Celular.avi'
                ];
            }
            
            // Filter by supported formats and create full paths
            const foundVideos = videoFiles
                .filter(file => config.videoFormats.some(format => file.toLowerCase().endsWith(format)))
                .map(file => ({
                    name: file,
                    path: folder.endsWith('\\') || folder.endsWith('/') 
                        ? `${folder}${file}`
                        : `${folder}\\${file}`,
                    exists: true // In real app, this would check file existence
                }));
            
            // Simulate that some files might not exist (10% chance per file)
            return foundVideos.filter(video => {
                // 90% chance the file "exists" in our simulation
                return Math.random() < 0.9;
            });
        }
        
        // Update video list UI
        function updateVideoListUI() {
            videoList.innerHTML = '';
            
            if (config.videoList.length === 0) {
                videoList.innerHTML = '<p class="text-gray-400 text-center py-4">Nenhum vídeo encontrado</p>';
                return;
            }
            
            config.videoList.forEach((video, index) => {
                const videoItem = document.createElement('div');
                videoItem.className = `flex items-center p-2 rounded hover:bg-gray-700 cursor-pointer ${index === config.currentVideoIndex}` ? 'bg-blue-900' : '';
                
                // Icon based on file type
                const fileExt = video.path.split('.').pop().toLowerCase();
                let fileIcon = 'fa-file-video';
                
                if (fileExt === 'mp4') fileIcon = 'fa-file-video';
                else if (fileExt === 'avi') fileIcon = 'fa-file-video';
                else if (fileExt === 'mkv') fileIcon = 'fa-file-video';
                else if (fileExt === 'mov') fileIcon = 'fa-file-video';
                else if (fileExt === 'webm') fileIcon = 'fa-file-video';
                
                videoItem.innerHTML = `
                    <i class="fas ${fileIcon} mr-3 ${index === config.currentVideoIndex ? 'text-blue-400' : 'text-gray-400'}"></i>
                    <span class="truncate flex-1">${video.name}</span>
                    <span class="text-gray-400 text-sm">${fileExt.toUpperCase()}</span>
                `;
                videoItem.addEventListener('click', () => playVideoByIndex(index));
                videoList.appendChild(videoItem);
            });
        }
        
        // Play video by index
        function playVideoByIndex(index) {
            if (index < 0 || index >= config.videoList.length) return;
            
            config.currentVideoIndex = index;
            const video = config.videoList[index];
            
            // In a real app, this would set the actual video source
            // For demo, we'll just simulate it with a sample video
            videoPlayer.src = `https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4`;
            videoPlayer.load();
            
            if (config.autoplay) {
                videoPlayer.play().catch(e => {
                    console.error('Autoplay prevented:', e);
                    showMessage('Clique para reproduzir (autoplay bloqueado)');
                });
            }
            
            // Update UI
            currentVideoTitle.textContent = video.name;
            videoCount.textContent = `${index + 1}/${config.videoList.length}`;
            updateVideoListUI();
            updateUI();
        }
        
        // Play next video
        function playNextVideo() {
            let nextIndex = config.currentVideoIndex + 1;
            
            if (nextIndex >= config.videoList.length) {
                if (config.loopPlaylist) {
                    nextIndex = 0;
                } else {
                    // End of playlist, no looping
                    showMessage('Fim da playlist');
                    return;
                }
            }
            
            playVideoByIndex(nextIndex);
        }
        
        // Play previous video
        function playPreviousVideo() {
            let prevIndex = config.currentVideoIndex - 1;
            
            if (prevIndex < 0) {
                if (config.loopPlaylist) {
                    prevIndex = config.videoList.length - 1;
                } else {
                    // Beginning of playlist, no looping
                    return;
                }
            }
            
            playVideoByIndex(prevIndex);
        }
        
        // Start scan timer
        function startScanTimer() {
            // Clear existing timer if any
            if (window.scanTimer) {
                clearInterval(window.scanTimer);
            }
            
            // Set new timer
            const intervalMinutes = parseInt(scanInterval.value) || 60;
            const intervalMs = intervalMinutes * 60 * 1000;
            
            window.scanTimer = setInterval(() => {
                checkFolderAndScan();
            }, intervalMs);
            
            // Update status
            config.lastScanTime = new Date();
            updateScanStatus();
        }
        
        // Update scan status UI
        function updateScanStatus() {
            if (!config.lastScanTime) return;
            
            const nextScan = new Date(config.lastScanTime.getTime() + (config.scanInterval * 60 * 1000));
            const now = new Date();
            const timeLeft = Math.max(0, Math.floor((nextScan - now) / 60000)); // in minutes
            
            let timeText;
            if (timeLeft === 0) {
                timeText = 'em breve';
            } else if (timeLeft === 1) {
                timeText = '1 minuto';
            } else {
                timeText = `${timeLeft} minutos`;
            }
            
            nextScanTime.textContent = timeText;
        }
        
        // Show brief message
        function showMessage(text) {
            messageElement.textContent = text;
            messageElement.style.display = 'block';
            
            setTimeout(() => {
                messageElement.style.display = 'none';
            }, 3000);
        }
        
        // Update all UI elements
        function updateUI() {
            updatePlayPauseButton();
            updateVolumeButton();
            updateProgressBar();
            updateScanStatus();
        }
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>